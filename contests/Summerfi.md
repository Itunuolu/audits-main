## Summer.fi
[Contest Details](https://audits.sherlock.xyz/contests/1176/report)

### [Issue M-3] Foundation recall will inflate governance power for earnest voters

**Summary**

Missing logic to reduce escrowed weights after `recallUnvestedTokens` will cause an enduring governance power inflation for honest voters as the Foundation will legitimately claw back performance tokens while stakers keep the corresponding xSUMR and voting weight.

**Root Cause**
In https://github.com/sherlock-audit/2025-09-summer-fi-governance-v2/blob/main/summer-earn-protocol/packages/gov-contracts/src/contracts/SummerVestingWalletsEscrow.sol?plain#L333-L336 and https://github.com/sherlock-audit/2025-09-summer-fi-governance-v2/blob/main/summer-earn-protocol/packages/gov-contracts/src/contracts/SummerVestingWalletsEscrow.sol?plain#L258 the escrow mints xSUMR against the vesting wallet balance at stake time but never re-syncs or burns when https://github.com/sherlock-audit/2025-09-summer-fi-governance-v2/blob/main/summer-earn-protocol/packages/gov-contracts/src/contracts/SummerVestingWallet.sol?plain#L137-L149 reduces that balance via `recallUnvestedTokens`.

**Internal Pre-conditions**

1. [Foundation needs to call] `SummerVestingWallet.recallUnvestedTokens()` to set the vesting wallet SUMR balance to less than the snapshot taken at stake time.
2. [Delegatee needs to keep] the escrow position staked so that `_unstakeFromFactory` is not executed to burn the excess xSUMR.

**External Pre-conditions**
None

**Attack Path**
1. Foundation executes `recallUnvestedTokens()` on a team vesting wallet while it is staked in the escrow.
2. The staker leaves the position staked (or restakes after recall) so the escrow keeps the stale `stakedBalance`.
3. The protocol continues to account full xSUMR supply and voting power for the staker despite the reduced backing tokens.

**Impact**

The wider governance community suffers an unbounded loss of voting fairness and reward dilution. (The opportunistic staker gains inflated voting power and reward share without holding the corresponding SUMR.)

**Mitigation**
Recompute the escrowed balance on every unstake and after recalls (or prevent recalls while staked) so that xSUMR minted for vesting wallets always matches the underlying SUMR still held.
